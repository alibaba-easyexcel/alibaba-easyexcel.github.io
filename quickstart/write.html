<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">

    <title>Alibaba Easy Excel - 简单、省内存的Java解析Excel工具 | 写Excel </title>
    <meta name="description" content>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <!-- fonts -->
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,600,700" rel="stylesheet">

    <!-- stylesheets -->
    <link rel="stylesheet" href="/style/doc.css">

    <!-- favicon -->
    <link rel="icon" href="/images/favicon.ico">

    

  </head>
  <body>

   <script>window.__INITIAL_STATE__ = {"page":{"title":"写Excel","path":"quickstart/write.html"},"data":{"navigation":{"logo":{"text":"Easy Excel","type":"link","path":"index.html"},"main":[{"text":"首页","type":"link","path":"index.html"},{"text":"快速开始","type":"label"},{"text":"常见问题（建议先阅读这个）","type":"link","path":"quickstart/faq.html"},{"text":"读Excel","type":"link","path":"quickstart/read.html"},{"text":"写Excel","type":"link","path":"quickstart/write.html"},{"text":"填充Excel","type":"link","path":"quickstart/fill.html"},{"text":"常见api","type":"link","path":"quickstart/api.html"},{"text":"支持和反馈","type":"label"},{"text":"关于EasyExcel","type":"link","path":"support/about.html"},{"text":"在github上面留言","type":"link","path":"https://github.com/alibaba/easyexcel/issues/new/choose"}]}},"config":{"timezone":"UTC","root":"/","time_format":"HH:mm:ss","theme":"../node_modules/hexo-theme-doc","theme_config":{"swagger_ui":{"version":2,"permalinks":true,"api_explorer":true,"download":"Download specification","show_extensions":false,"deep_linking":true,"display_operation_id":false,"doc_expansion":"none"},"search":{"skip":false,"background":false,"route":"/lunr.json"},"favicon":"images/favicon.ico"}}}</script>

    <div id="react-navigation-root"><div class="doc-navigation" data-reactroot><nav class="doc-navbar"><a href="/index.html" class="doc-navbar__logo"><img src="/images/logo.png" class="doc-navbar__logo__img"><span class="doc-navbar__logo__text">Easy Excel</span></a><i class="dc-icon dc-icon--close dc-icon--interactive doc-sidebar-close doc-navbar__sidebar-close doc-navbar__sidebar-close--desktop"></i><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-navbar__sidebar-toggle"></i></nav><nav class="doc-sidebar"><div class="doc-sidebar__vertical-menu"><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-sidebar-toggle--primary doc-sidebar__vertical-menu__item"></i><i class="dc-icon dc-icon--search dc-icon--interactive doc-sidebar__vertical-menu__item doc-sidebar__vertical-menu__item--primary"></i></div><div class="doc-sidebar-content"><div class="doc-sidebar__search-form"></div><ul class="doc-sidebar-list"></ul></div></nav></div></div>
    <div class="doc-content">
  <div class="dc-page">
    <div class="dc-card">
      <div id="react-search-results-root"></div>
      <div id="page-content" class="doc-formatting">
        <h3 id="通用数据生成-后面不会重复写"><a href="#通用数据生成-后面不会重复写" class="headerlink" title="通用数据生成 后面不会重复写"></a>通用数据生成 后面不会重复写</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> List&lt;DemoData&gt; <span class="title">data</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;DemoData&gt; list = <span class="keyword">new</span> ArrayList&lt;DemoData&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        DemoData data = <span class="keyword">new</span> DemoData();</span><br><span class="line">        data.setString(<span class="string">"字符串"</span> + i);</span><br><span class="line">        data.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">        data.setDoubleData(<span class="number">0.56</span>);</span><br><span class="line">        list.add(data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最简单的写"><a href="#最简单的写" class="headerlink" title="最简单的写"></a><span id="simpleWrite">最简单的写</span></h2><h3 id="excel示例"><a href="#excel示例" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/simpleWrite.png" alt="img"></p>
<h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a><span id="simpleWriteObject">对象</span></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"字符串标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"日期标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"数字标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 忽略这个字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String ignore;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 最简单的写</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 写法1</span></span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"simpleWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    <span class="comment">// 如果这里想使用03 则 传入excelType参数即可</span></span><br><span class="line">    EasyExcel.write(fileName, DemoData.class).sheet(<span class="string">"模板"</span>).doWrite(data());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写法2</span></span><br><span class="line">    fileName = TestFileUtil.getPath() + <span class="string">"simpleWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读</span></span><br><span class="line">    ExcelWriter excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br><span class="line">    WriteSheet writeSheet = EasyExcel.writerSheet(<span class="string">"模板"</span>).build();</span><br><span class="line">    excelWriter.write(data(), writeSheet);</span><br><span class="line">    <span class="comment">/// 千万别忘记finish 会帮忙关闭流</span></span><br><span class="line">    excelWriter.finish();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="指定写入的列"><a href="#指定写入的列" class="headerlink" title="指定写入的列"></a><span id="indexWrite">指定写入的列</span></h2><h3 id="excel示例-1"><a href="#excel示例-1" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/indexWrite.png" alt="img"></p>
<h3 id="对象-1"><a href="#对象-1" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"字符串标题"</span>, index = <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"日期标题"</span>, index = <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这里设置3 会导致第二列空的</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"数字标题"</span>, index = <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 指定写入的列</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> IndexData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 使用&#123;<span class="doctag">@link</span> ExcelProperty&#125;注解指定写入的列</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"indexWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    EasyExcel.write(fileName, IndexData.class).sheet(<span class="string">"模板"</span>).doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="复杂头写入"><a href="#复杂头写入" class="headerlink" title="复杂头写入"></a><span id="complexHeadWrite">复杂头写入</span></h2><h3 id="excel示例-2"><a href="#excel示例-2" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/complexHeadWrite.png" alt="img"></p>
<h3 id="对象-2"><a href="#对象-2" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ComplexHeadData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(&#123;<span class="string">"主标题"</span>, <span class="string">"字符串标题"</span>&#125;)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(&#123;<span class="string">"主标题"</span>, <span class="string">"日期标题"</span>&#125;)</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(&#123;<span class="string">"主标题"</span>, <span class="string">"数字标题"</span>&#125;)</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 复杂头写入</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> ComplexHeadData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 使用&#123;<span class="doctag">@link</span> ExcelProperty&#125;注解指定复杂的头</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">complexHeadWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"complexHeadWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    EasyExcel.write(fileName, ComplexHeadData.class).sheet(<span class="string">"模板"</span>).doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="重复多次写入"><a href="#重复多次写入" class="headerlink" title="重复多次写入"></a><span id="repeatedWrite">重复多次写入</span></h2><h3 id="excel示例-3"><a href="#excel示例-3" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/repeatedWrite.png" alt="img"></p>
<h3 id="对象-3"><a href="#对象-3" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a></p>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 重复多次写入</span></span><br><span class="line"><span class="comment">   * &lt;p&gt;</span></span><br><span class="line"><span class="comment">   * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> ComplexHeadData&#125;</span></span><br><span class="line"><span class="comment">   * &lt;p&gt;</span></span><br><span class="line"><span class="comment">   * 2. 使用&#123;<span class="doctag">@link</span> ExcelProperty&#125;注解指定复杂的头</span></span><br><span class="line"><span class="comment">   * &lt;p&gt;</span></span><br><span class="line"><span class="comment">   * 3. 直接调用二次写入即可</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">repeatedWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="comment">// 方法1 如果写到同一个sheet</span></span><br><span class="line">      String fileName = TestFileUtil.getPath() + <span class="string">"repeatedWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">      <span class="comment">// 这里 需要指定写用哪个class去读</span></span><br><span class="line">      ExcelWriter excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br><span class="line">      <span class="comment">// 这里注意 如果同一个sheet只要创建一次</span></span><br><span class="line">      WriteSheet writeSheet = EasyExcel.writerSheet(<span class="string">"模板"</span>).build();</span><br><span class="line">      <span class="comment">// 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">          <span class="comment">// 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span></span><br><span class="line">          List&lt;DemoData&gt; data = data();</span><br><span class="line">          excelWriter.write(data, writeSheet);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/// 千万别忘记finish 会帮忙关闭流</span></span><br><span class="line">      excelWriter.finish();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 方法2 如果写到不同的sheet 同一个对象</span></span><br><span class="line">      fileName = TestFileUtil.getPath() + <span class="string">"repeatedWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">      <span class="comment">// 这里 指定文件</span></span><br><span class="line">      excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br><span class="line">      <span class="comment">// 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来。这里最终会写到5个sheet里面</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">          <span class="comment">// 每次都要创建writeSheet 这里注意必须指定sheetNo</span></span><br><span class="line">          writeSheet = EasyExcel.writerSheet(i, <span class="string">"模板"</span>).build();</span><br><span class="line">          <span class="comment">// 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span></span><br><span class="line">          List&lt;DemoData&gt; data = data();</span><br><span class="line">          excelWriter.write(data, writeSheet);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/// 千万别忘记finish 会帮忙关闭流</span></span><br><span class="line">      excelWriter.finish();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 方法3 如果写到不同的sheet 不同的对象</span></span><br><span class="line">      fileName = TestFileUtil.getPath() + <span class="string">"repeatedWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">      <span class="comment">// 这里 指定文件</span></span><br><span class="line">      excelWriter = EasyExcel.write(fileName).build();</span><br><span class="line">      <span class="comment">// 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来。这里最终会写到5个sheet里面</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">          <span class="comment">// 每次都要创建writeSheet 这里注意必须指定sheetNo。这里注意DemoData.class 可以每次都变，我这里为了方便 所以用的同一个class 实际上可以一直变</span></span><br><span class="line">          writeSheet = EasyExcel.writerSheet(i, <span class="string">"模板"</span>).head(DemoData.class).build();</span><br><span class="line">          <span class="comment">// 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span></span><br><span class="line">          List&lt;DemoData&gt; data = data();</span><br><span class="line">          excelWriter.write(data, writeSheet);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/// 千万别忘记finish 会帮忙关闭流</span></span><br><span class="line">      excelWriter.finish();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="日期、数字或者自定义格式转换"><a href="#日期、数字或者自定义格式转换" class="headerlink" title="日期、数字或者自定义格式转换"></a><span id="converterWrite">日期、数字或者自定义格式转换</span></h2><h3 id="excel示例-4"><a href="#excel示例-4" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/converterWrite.png" alt="img"></p>
<h3 id="对象-4"><a href="#对象-4" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConverterData</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 我想所有的 字符串起前面加上"自定义："三个字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"字符串标题"</span>, converter = CustomStringStringConverter.class)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 我想写到excel 用年月日的格式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DateTimeFormat</span>(<span class="string">"yyyy年MM月dd日HH时mm分ss秒"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"日期标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 我想写到excel 用百分比表示</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@NumberFormat</span>(<span class="string">"#.##%"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"数字标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 日期、数字或者自定义格式转换</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> ConverterData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 使用&#123;<span class="doctag">@link</span> ExcelProperty&#125;配合使用注解&#123;<span class="doctag">@link</span> DateTimeFormat&#125;、&#123;<span class="doctag">@link</span> NumberFormat&#125;或者自定义注解</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">converterWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"converterWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    EasyExcel.write(fileName, ConverterData.class).sheet(<span class="string">"模板"</span>).doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="图片导出"><a href="#图片导出" class="headerlink" title="图片导出"></a><span id="imageWrite">图片导出</span></h2><h3 id="excel示例-5"><a href="#excel示例-5" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/imageWrite.png" alt="img"></p>
<h3 id="对象-5"><a href="#对象-5" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ContentRowHeight</span>(<span class="number">100</span>)</span><br><span class="line"><span class="meta">@ColumnWidth</span>(<span class="number">100</span> / <span class="number">8</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageData</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> File file;</span><br><span class="line">    <span class="keyword">private</span> InputStream inputStream;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 如果string类型 必须指定转换器，string默认转换成string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(converter = StringImageConverter.class)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] byteArray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 图片导出</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> ImageData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">imageWrite</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"imageWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 如果使用流 记得关闭</span></span><br><span class="line">    InputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        List&lt;ImageData&gt; list = <span class="keyword">new</span> ArrayList&lt;ImageData&gt;();</span><br><span class="line">        ImageData imageData = <span class="keyword">new</span> ImageData();</span><br><span class="line">        list.add(imageData);</span><br><span class="line">        String imagePath = TestFileUtil.getPath() + <span class="string">"converter"</span> + File.separator + <span class="string">"img.jpg"</span>;</span><br><span class="line">        <span class="comment">// 放入四种类型的图片 实际使用只要选一种即可</span></span><br><span class="line">        imageData.setByteArray(FileUtils.readFileToByteArray(<span class="keyword">new</span> File(imagePath)));</span><br><span class="line">        imageData.setFile(<span class="keyword">new</span> File(imagePath));</span><br><span class="line">        imageData.setString(imagePath);</span><br><span class="line">        inputStream = FileUtils.openInputStream(<span class="keyword">new</span> File(imagePath));</span><br><span class="line">        imageData.setInputStream(inputStream);</span><br><span class="line">        EasyExcel.write(fileName, ImageData.class).sheet().doWrite(list);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (inputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">            inputStream.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="根据模板写入"><a href="#根据模板写入" class="headerlink" title="根据模板写入"></a><span id="templateWrite">根据模板写入</span></h2><h3 id="模板excel示例"><a href="#模板excel示例" class="headerlink" title="模板excel示例"></a>模板excel示例</h3><p>参照：<a href="#simpleReadExcel">模板excel示例</a></p>
<h3 id="excel示例-6"><a href="#excel示例-6" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/templateWrite.png" alt="img"></p>
<h3 id="对象-6"><a href="#对象-6" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a></p>
<h3 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据模板写入</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> IndexData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 使用&#123;<span class="doctag">@link</span> ExcelProperty&#125;注解指定写入的列</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 使用withTemplate 读取模板</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;4. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">templateWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String templateFileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"templateWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    EasyExcel.write(fileName, DemoData.class).withTemplate(templateFileName).sheet().doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="列宽、行高"><a href="#列宽、行高" class="headerlink" title="列宽、行高"></a><span id="widthAndHeightWrite">列宽、行高</span></h2><h3 id="excel示例-7"><a href="#excel示例-7" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/widthAndHeightWrite.png" alt="img"></p>
<h3 id="对象-7"><a href="#对象-7" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ContentRowHeight</span>(<span class="number">10</span>)</span><br><span class="line"><span class="meta">@HeadRowHeight</span>(<span class="number">20</span>)</span><br><span class="line"><span class="meta">@ColumnWidth</span>(<span class="number">25</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WidthAndHeightData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"字符串标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"日期标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 宽度为50</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">50</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"数字标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 列宽、行高</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> WidthAndHeightData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 使用注解&#123;<span class="doctag">@link</span> ColumnWidth&#125;、&#123;<span class="doctag">@link</span> HeadRowHeight&#125;、&#123;<span class="doctag">@link</span> ContentRowHeight&#125;指定宽度或高度</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">widthAndHeightWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"widthAndHeightWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    EasyExcel.write(fileName, WidthAndHeightData.class).sheet(<span class="string">"模板"</span>).doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自定义样式"><a href="#自定义样式" class="headerlink" title="自定义样式"></a><span id="styleWrite">自定义样式</span></h2><h3 id="excel示例-8"><a href="#excel示例-8" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/styleWrite.png" alt="img"></p>
<h3 id="对象-8"><a href="#对象-8" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a></p>
<h3 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义样式</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 创建一个style策略 并注册</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">styleWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"styleWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 头的策略</span></span><br><span class="line">    WriteCellStyle headWriteCellStyle = <span class="keyword">new</span> WriteCellStyle();</span><br><span class="line">    <span class="comment">// 背景设置为红色</span></span><br><span class="line">    headWriteCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br><span class="line">    WriteFont headWriteFont = <span class="keyword">new</span> WriteFont();</span><br><span class="line">    headWriteFont.setFontHeightInPoints((<span class="keyword">short</span>)<span class="number">20</span>);</span><br><span class="line">    headWriteCellStyle.setWriteFont(headWriteFont);</span><br><span class="line">    <span class="comment">// 内容的策略</span></span><br><span class="line">    WriteCellStyle contentWriteCellStyle = <span class="keyword">new</span> WriteCellStyle();</span><br><span class="line">    <span class="comment">// 这里需要指定 FillPatternType 为FillPatternType.SOLID_FOREGROUND 不然无法显示背景颜色.头默认了 FillPatternType所以可以不指定</span></span><br><span class="line">    contentWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">    <span class="comment">// 背景绿色</span></span><br><span class="line">    contentWriteCellStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex());</span><br><span class="line">    WriteFont contentWriteFont = <span class="keyword">new</span> WriteFont();</span><br><span class="line">    <span class="comment">// 字体大小</span></span><br><span class="line">    contentWriteFont.setFontHeightInPoints((<span class="keyword">short</span>)<span class="number">20</span>);</span><br><span class="line">    contentWriteCellStyle.setWriteFont(contentWriteFont);</span><br><span class="line">    <span class="comment">// 这个策略是 头是头的样式 内容是内容的样式 其他的策略可以自己实现</span></span><br><span class="line">    HorizontalCellStyleStrategy horizontalCellStyleStrategy =</span><br><span class="line">        <span class="keyword">new</span> HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    EasyExcel.write(fileName, DemoData.class).registerWriteHandler(horizontalCellStyleStrategy).sheet(<span class="string">"模板"</span>)</span><br><span class="line">        .doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="合并单元格"><a href="#合并单元格" class="headerlink" title="合并单元格"></a><span id="mergeWrite">合并单元格</span></h2><h3 id="excel示例-9"><a href="#excel示例-9" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/mergeWrite.png" alt="img"></p>
<h3 id="对象-9"><a href="#对象-9" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a></p>
<h3 id="代码-9"><a href="#代码-9" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 合并单元格</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;2. 创建一个merge策略 并注册</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;3. 直接写即可</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mergeWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     String fileName = TestFileUtil.getPath() + <span class="string">"mergeWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">     <span class="comment">// 每隔2行会合并 把eachColumn 设置成 3 也就是我们数据的长度，所以就第一列会合并。当然其他合并策略也可以自己写</span></span><br><span class="line">     LoopMergeStrategy loopMergeStrategy = <span class="keyword">new</span> LoopMergeStrategy(<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">     <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">     EasyExcel.write(fileName, DemoData.class).registerWriteHandler(loopMergeStrategy).sheet(<span class="string">"模板"</span>)</span><br><span class="line">         .doWrite(data());</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="使用table去写入"><a href="#使用table去写入" class="headerlink" title="使用table去写入"></a><span id="tableWrite">使用table去写入</span></h2><h3 id="excel示例-10"><a href="#excel示例-10" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/tableWrite.png" alt="img"></p>
<h3 id="对象-10"><a href="#对象-10" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a></p>
<h3 id="代码-10"><a href="#代码-10" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 使用table去写入</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;2. 然后写入table即可</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tableWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     String fileName = TestFileUtil.getPath() + <span class="string">"tableWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">     <span class="comment">// 这里直接写多个table的案例了，如果只有一个 也可以直一行代码搞定，参照其他案例</span></span><br><span class="line">     <span class="comment">// 这里 需要指定写用哪个class去读</span></span><br><span class="line">     ExcelWriter excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br><span class="line">     <span class="comment">// 把sheet设置为不需要头 不然会输出sheet的头 这样看起来第一个table 就有2个头了</span></span><br><span class="line">     WriteSheet writeSheet = EasyExcel.writerSheet(<span class="string">"模板"</span>).needHead(Boolean.FALSE).build();</span><br><span class="line">     <span class="comment">// 这里必须指定需要头，table 会继承sheet的配置，sheet配置了不需要，table 默认也是不需要</span></span><br><span class="line">     WriteTable writeTable0 = EasyExcel.writerTable(<span class="number">0</span>).needHead(Boolean.TRUE).build();</span><br><span class="line">     WriteTable writeTable1 = EasyExcel.writerTable(<span class="number">1</span>).needHead(Boolean.TRUE).build();</span><br><span class="line">     <span class="comment">// 第一次写入会创建头</span></span><br><span class="line">     excelWriter.write(data(), writeSheet, writeTable0);</span><br><span class="line">     <span class="comment">// 第二次写如也会创建头，然后在第一次的后面写入数据</span></span><br><span class="line">     excelWriter.write(data(), writeSheet, writeTable1);</span><br><span class="line">     <span class="comment">/// 千万别忘记finish 会帮忙关闭流</span></span><br><span class="line">     excelWriter.finish();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="动态头，实时生成头写入"><a href="#动态头，实时生成头写入" class="headerlink" title="动态头，实时生成头写入"></a><span id="tableWrite">动态头，实时生成头写入</span></h2><h3 id="excel示例-11"><a href="#excel示例-11" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/dynamicHeadWrite.png" alt="img"></p>
<h3 id="对象-11"><a href="#对象-11" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a></p>
<h3 id="代码-11"><a href="#代码-11" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 动态头，实时生成头写入</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 思路是这样子的，先创建List&lt;String&gt;头格式的sheet仅仅写入头,然后通过table 不写入头的方式 去写入数据</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. 然后写入table即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dynamicHeadWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"dynamicHeadWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    EasyExcel.write(fileName)</span><br><span class="line">        <span class="comment">// 这里放入动态头</span></span><br><span class="line">        .head(head()).sheet(<span class="string">"模板"</span>)</span><br><span class="line">        <span class="comment">// 当然这里数据也可以用 List&lt;List&lt;String&gt;&gt; 去传入</span></span><br><span class="line">        .doWrite(data());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> List&lt;List&lt;String&gt;&gt; head() &#123;</span><br><span class="line">    List&lt;List&lt;String&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;List&lt;String&gt;&gt;();</span><br><span class="line">    List&lt;String&gt; head0 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    head0.add(<span class="string">"字符串"</span> + System.currentTimeMillis());</span><br><span class="line">    List&lt;String&gt; head1 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    head1.add(<span class="string">"数字"</span> + System.currentTimeMillis());</span><br><span class="line">    List&lt;String&gt; head2 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    head2.add(<span class="string">"日期"</span> + System.currentTimeMillis());</span><br><span class="line">    list.add(head0);</span><br><span class="line">    list.add(head1);</span><br><span class="line">    list.add(head2);</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自动列宽-不太精确"><a href="#自动列宽-不太精确" class="headerlink" title="自动列宽(不太精确)"></a><span id="longestMatchColumnWidthWrite">自动列宽(不太精确)</span></h2><h3 id="excel示例-12"><a href="#excel示例-12" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/longestMatchColumnWidthWrite.png" alt="img"></p>
<h3 id="对象-12"><a href="#对象-12" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LongestMatchColumnWidthData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"字符串标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"日期标题很长日期标题很长日期标题很长很长"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"数字"</span>)</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-12"><a href="#代码-12" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 自动列宽(不太精确)</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * 这个目前不是很好用，比如有数字就会导致换行。而且长度也不是刚好和实际长度一致。 所以需要精确到刚好列宽的慎用。 当然也可以自己参照</span></span><br><span class="line"><span class="comment">  * &#123;<span class="doctag">@link</span> LongestMatchColumnWidthStyleStrategy&#125;重新实现.</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * poi 自带&#123;<span class="doctag">@link</span> SXSSFSheet#autoSizeColumn(int)&#125; 对中文支持也不太好。目前没找到很好的算法。 有的话可以推荐下。</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> LongestMatchColumnWidthData&#125;</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * 2. 注册策略&#123;<span class="doctag">@link</span> LongestMatchColumnWidthStyleStrategy&#125;</span></span><br><span class="line"><span class="comment">  * &lt;p&gt;</span></span><br><span class="line"><span class="comment">  * 3. 直接写即可</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">longestMatchColumnWidthWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     String fileName =</span><br><span class="line">         TestFileUtil.getPath() + <span class="string">"longestMatchColumnWidthWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">     <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">     EasyExcel.write(fileName, LongestMatchColumnWidthData.class)</span><br><span class="line">         .registerWriteHandler(<span class="keyword">new</span> LongestMatchColumnWidthStyleStrategy()).sheet(<span class="string">"模板"</span>).doWrite(dataLong());</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">private</span> List&lt;LongestMatchColumnWidthData&gt; <span class="title">dataLong</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     List&lt;LongestMatchColumnWidthData&gt; list = <span class="keyword">new</span> ArrayList&lt;LongestMatchColumnWidthData&gt;();</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">         LongestMatchColumnWidthData data = <span class="keyword">new</span> LongestMatchColumnWidthData();</span><br><span class="line">         data.setString(<span class="string">"测试很长的字符串测试很长的字符串测试很长的字符串"</span> + i);</span><br><span class="line">         data.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">         data.setDoubleData(<span class="number">1000000000000.0</span>);</span><br><span class="line">         list.add(data);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> list;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）"><a href="#自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）" class="headerlink" title="自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）"></a><span id="customHandlerWrite">自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）</span></h2><h3 id="excel示例-13"><a href="#excel示例-13" class="headerlink" title="excel示例"></a>excel示例</h3><p><img src="/images/quickstart/write/customHandlerWrite.png" alt="img"></p>
<h3 id="对象-13"><a href="#对象-13" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a></p>
<h3 id="定义拦截器"><a href="#定义拦截器" class="headerlink" title="定义拦截器"></a>定义拦截器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义拦截器。对第一行第一列的头超链接到:https://github.com/alibaba/easyexcel</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Jiaju Zhuang</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomCellWriteHandler</span> <span class="keyword">implements</span> <span class="title">CellWriteHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(CustomCellWriteHandler.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeCellCreate</span><span class="params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Row row,</span></span></span><br><span class="line"><span class="function"><span class="params">        Head head, Integer columnIndex, Integer relativeRowIndex, Boolean isHead)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCellCreate</span><span class="params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Cell cell,</span></span></span><br><span class="line"><span class="function"><span class="params">        Head head, Integer relativeRowIndex, Boolean isHead)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCellDispose</span><span class="params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder,</span></span></span><br><span class="line"><span class="function"><span class="params">        List&lt;CellData&gt; cellDataList, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 这里可以对cell进行任何操作</span></span><br><span class="line">        LOGGER.info(<span class="string">"第&#123;&#125;行，第&#123;&#125;列写入完成。"</span>, cell.getRowIndex(), cell.getColumnIndex());</span><br><span class="line">        <span class="keyword">if</span> (isHead &amp;&amp; cell.getColumnIndex() == <span class="number">0</span>) &#123;</span><br><span class="line">            CreationHelper createHelper = writeSheetHolder.getSheet().getWorkbook().getCreationHelper();</span><br><span class="line">            Hyperlink hyperlink = createHelper.createHyperlink(HyperlinkType.URL);</span><br><span class="line">            hyperlink.setAddress(<span class="string">"https://github.com/alibaba/easyexcel"</span>);</span><br><span class="line">            cell.setHyperlink(hyperlink);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义拦截器.对第一列第一行和第二行的数据新增下拉框，显示 测试1 测试2</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Jiaju Zhuang</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomSheetWriteHandler</span> <span class="keyword">implements</span> <span class="title">SheetWriteHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(CustomSheetWriteHandler.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeSheetCreate</span><span class="params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterSheetCreate</span><span class="params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> </span>&#123;</span><br><span class="line">        LOGGER.info(<span class="string">"第&#123;&#125;个Sheet写入成功。"</span>, writeSheetHolder.getSheetNo());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 区间设置 第一列第一行和第二行的数据。由于第一行是头，所以第一、二行的数据实际上是第二三行</span></span><br><span class="line">        CellRangeAddressList cellRangeAddressList = <span class="keyword">new</span> CellRangeAddressList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        DataValidationHelper helper = writeSheetHolder.getSheet().getDataValidationHelper();</span><br><span class="line">        DataValidationConstraint constraint = helper.createExplicitListConstraint(<span class="keyword">new</span> String[] &#123;<span class="string">"测试1"</span>, <span class="string">"测试2"</span>&#125;);</span><br><span class="line">        DataValidation dataValidation = helper.createValidation(constraint, cellRangeAddressList);</span><br><span class="line">        writeSheetHolder.getSheet().addValidationData(dataValidation);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-13"><a href="#代码-13" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 下拉，超链接等自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * demo这里实现2点。1. 对第一行第一列的头超链接到:https://github.com/alibaba/easyexcel 2. 对第一列第一行和第二行的数据新增下拉框，显示 测试1 测试2</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. 注册拦截器 &#123;<span class="doctag">@link</span> CustomCellWriteHandler&#125; &#123;<span class="doctag">@link</span> CustomSheetWriteHandler&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. 直接写即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">customHandlerWrite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"customHandlerWrite"</span> + System.currentTimeMillis() + <span class="string">".xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定写用哪个class去读，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span></span><br><span class="line">    EasyExcel.write(fileName, DemoData.class).registerWriteHandler(<span class="keyword">new</span> CustomSheetWriteHandler())</span><br><span class="line">        .registerWriteHandler(<span class="keyword">new</span> CustomCellWriteHandler()).sheet(<span class="string">"模板"</span>).doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="web中的写"><a href="#web中的写" class="headerlink" title="web中的写"></a><span id="webWrite">web中的写</span></h2><h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><p>DEMO代码地址：<a href="/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java">https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java</a></p>
<h3 id="对象-14"><a href="#对象-14" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleWriteObject">对象</a> 就是名称变了下</p>
<h3 id="代码-14"><a href="#代码-14" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文件下载</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DownloadData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. 设置返回的 参数</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 3. 直接写，这里注意，finish的时候会自动关闭OutputStream,当然你外面再关闭流问题不大</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"download"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">download</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">// 这里注意 有同学反应使用swagger 会导致各种问题，请直接用浏览器或者用postman</span></span><br><span class="line">    response.setContentType(<span class="string">"application/vnd.ms-excel"</span>);</span><br><span class="line">    response.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">    <span class="comment">// 这里URLEncoder.encode可以防止中文乱码 当然和easyexcel没有关系</span></span><br><span class="line">    String fileName = URLEncoder.encode(<span class="string">"测试"</span>, <span class="string">"UTF-8"</span>);</span><br><span class="line">    response.setHeader(<span class="string">"Content-disposition"</span>, <span class="string">"attachment;filename="</span> + fileName + <span class="string">".xlsx"</span>);</span><br><span class="line">    EasyExcel.write(response.getOutputStream(), DownloadData.class).sheet(<span class="string">"模板"</span>).doWrite(data());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        <div id="react-support-footer-root"></div>
      </div>
    </div>
  </div>
</div>

    


    

    <!-- js vendors -->
    <script src="//code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.0/lunr.min.js"></script>

    <!-- js source  -->
    <script src="/script/doc.js"></script>

    

  </body>
</html>
