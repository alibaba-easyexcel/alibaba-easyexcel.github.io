<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">

    <title>Alibaba Easy Excel - 简单、省内存的Java解析Excel工具 | 读Excel </title>
    <meta name="description" content>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <!-- fonts -->
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,600,700" rel="stylesheet">

    <!-- stylesheets -->
    <link rel="stylesheet" href="/style/doc.css">

    <!-- favicon -->
    <link rel="icon" href="/images/favicon.ico">

    

  </head>
  <body>

   <script>window.__INITIAL_STATE__ = {"page":{"title":"读Excel","path":"quickstart/read.html"},"data":{"navigation":{"logo":{"text":"Easy Excel","type":"link","path":"index.html"},"main":[{"text":"首页","type":"link","path":"index.html"},{"text":"快速开始","type":"label"},{"text":"常见问题（建议先阅读这个）","type":"link","path":"quickstart/faq.html"},{"text":"读Excel","type":"link","path":"quickstart/read.html"},{"text":"写Excel","type":"link","path":"quickstart/write.html"},{"text":"填充Excel","type":"link","path":"quickstart/fill.html"},{"text":"常见api","type":"link","path":"quickstart/api.html"},{"text":"支持和反馈","type":"label"},{"text":"关于EasyExcel","type":"link","path":"support/about.html"},{"text":"在github上面留言","type":"link","path":"https://github.com/alibaba/easyexcel/issues/new/choose"}]}},"config":{"timezone":"UTC","root":"/","time_format":"HH:mm:ss","theme":"../node_modules/hexo-theme-doc","theme_config":{"swagger_ui":{"version":2,"permalinks":true,"api_explorer":true,"download":"Download specification","show_extensions":false,"deep_linking":true,"display_operation_id":false,"doc_expansion":"none"},"search":{"skip":false,"background":false,"route":"/lunr.json"},"favicon":"images/favicon.ico"}}}</script>

    <div id="react-navigation-root"><div class="doc-navigation" data-reactroot><nav class="doc-navbar"><a href="/index.html" class="doc-navbar__logo"><img src="/images/logo.png" class="doc-navbar__logo__img"><span class="doc-navbar__logo__text">Easy Excel</span></a><i class="dc-icon dc-icon--close dc-icon--interactive doc-sidebar-close doc-navbar__sidebar-close doc-navbar__sidebar-close--desktop"></i><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-navbar__sidebar-toggle"></i></nav><nav class="doc-sidebar"><div class="doc-sidebar__vertical-menu"><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-sidebar-toggle--primary doc-sidebar__vertical-menu__item"></i><i class="dc-icon dc-icon--search dc-icon--interactive doc-sidebar__vertical-menu__item doc-sidebar__vertical-menu__item--primary"></i></div><div class="doc-sidebar-content"><div class="doc-sidebar__search-form"></div><ul class="doc-sidebar-list"></ul></div></nav></div></div>
    <div class="doc-content">
  <div class="dc-page">
    <div class="dc-card">
      <div id="react-search-results-root"></div>
      <div id="page-content" class="doc-formatting">
        <h2 id="最简单的读"><a href="#最简单的读" class="headerlink" title="最简单的读"></a><span id="simpleRead">最简单的读</span></h2><h3 id="excel示例"><a href="#excel示例" class="headerlink" title="excel示例"></a><span id="simpleReadExcel">excel示例</span></h3><p><img src="/images/quickstart/read/demo.png" alt="img"></p>
<h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a><span id="simpleReadObject">对象</span></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoData</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a><span id="simpleReadListener">监听器</span></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoDataListener</span> <span class="keyword">extends</span> <span class="title">AnalysisEventListener</span>&lt;<span class="title">DemoData</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(DemoDataListener.class);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 每隔5条存储数据库，实际使用中可以3000条，然后清理list ，方便内存回收</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BATCH_COUNT = <span class="number">5</span>;</span><br><span class="line">    List&lt;DemoData&gt; list = <span class="keyword">new</span> ArrayList&lt;DemoData&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(DemoData data, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        LOGGER.info(<span class="string">"解析到一条数据:&#123;&#125;"</span>, JSON.toJSONString(data));</span><br><span class="line">        list.add(data);</span><br><span class="line">        <span class="keyword">if</span> (list.size() &gt;= BATCH_COUNT) &#123;</span><br><span class="line">            saveData();</span><br><span class="line">            list.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        saveData();</span><br><span class="line">        LOGGER.info(<span class="string">"所有数据解析完成！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加上存储数据库</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">saveData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        LOGGER.info(<span class="string">"&#123;&#125;条数据，开始存储数据库！"</span>, list.size());</span><br><span class="line">        LOGGER.info(<span class="string">"存储数据库成功！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 最简单的读</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> DemoDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 有个很重要的点 DemoDataListener 不能被spring管理，要每次读取excel都要new,然后里面用到spring可以构造方法传进去</span></span><br><span class="line">    <span class="comment">// 写法1：</span></span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet 文件流会自动关闭</span></span><br><span class="line">    EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> DemoDataListener()).sheet().doRead();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写法2：</span></span><br><span class="line">    fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    ExcelReader excelReader = EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> DemoDataListener()).build();</span><br><span class="line">    ReadSheet readSheet = EasyExcel.readSheet(<span class="number">0</span>).build();</span><br><span class="line">    excelReader.read(readSheet);</span><br><span class="line">    <span class="comment">// 这里千万别忘记关闭，读的时候会创建临时文件，到时磁盘会崩的</span></span><br><span class="line">    excelReader.finish();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="指定列的下标或者列名"><a href="#指定列的下标或者列名" class="headerlink" title="指定列的下标或者列名"></a><span id="indexOrNameRead">指定列的下标或者列名</span></h2><h3 id="excel示例-1"><a href="#excel示例-1" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-1"><a href="#对象-1" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexOrNameData</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 强制读取第三个 这里不建议 index 和 name 同时用，要么一个对象只用index，要么一个对象只用name去匹配</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(index = <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">private</span> Double doubleData;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用名字去匹配，这里需要注意，如果名字重复，会导致只有一个字段读取到数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"字符串标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"日期标题"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="监听器-1"><a href="#监听器-1" class="headerlink" title="监听器"></a>监听器</h3><p>参照：<a href="#simpleReadListener">监听器</a> 只是泛型变了而已</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 指定列的下标或者列名</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象,并使用&#123;<span class="doctag">@link</span> ExcelProperty&#125;注解. 参照&#123;<span class="doctag">@link</span> IndexOrNameData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> IndexOrNameDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexOrNameRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里默认读取第一个sheet</span></span><br><span class="line">    EasyExcel.read(fileName, IndexOrNameData.class, <span class="keyword">new</span> IndexOrNameDataListener()).sheet().doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="读多个sheet"><a href="#读多个sheet" class="headerlink" title="读多个sheet"></a><span id="repeatedRead">读多个sheet</span></h2><h3 id="excel示例-2"><a href="#excel示例-2" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-2"><a href="#对象-2" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleReadObject">对象</a></p>
<h3 id="监听器-2"><a href="#监听器-2" class="headerlink" title="监听器"></a>监听器</h3><p>参照：<a href="#simpleReadListener">监听器</a></p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 读多个或者全部sheet,这里注意一个sheet不能读取多次，多次读取需要重新读取文件</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> DemoDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">repeatedRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 读取全部sheet</span></span><br><span class="line">    <span class="comment">// 这里需要注意 DemoDataListener的doAfterAllAnalysed 会在每个sheet读取完毕后调用一次。然后所有sheet都会往同一个DemoDataListener里面写</span></span><br><span class="line">    EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> DemoDataListener()).doReadAll();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取部分sheet</span></span><br><span class="line">    fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    ExcelReader excelReader = EasyExcel.read(fileName).build();</span><br><span class="line">    <span class="comment">// 这里为了简单 所以注册了 同样的head 和Listener 自己使用功能必须不同的Listener</span></span><br><span class="line">    ReadSheet readSheet1 =</span><br><span class="line">        EasyExcel.readSheet(<span class="number">0</span>).head(DemoData.class).registerReadListener(<span class="keyword">new</span> DemoDataListener()).build();</span><br><span class="line">    ReadSheet readSheet2 =</span><br><span class="line">        EasyExcel.readSheet(<span class="number">1</span>).head(DemoData.class).registerReadListener(<span class="keyword">new</span> DemoDataListener()).build();</span><br><span class="line">    <span class="comment">// 这里注意 一定要把sheet1 sheet2 一起传进去，不然有个问题就是03版的excel 会读取多次，浪费性能</span></span><br><span class="line">    excelReader.read(readSheet1, readSheet2);</span><br><span class="line">    <span class="comment">// 这里千万别忘记关闭，读的时候会创建临时文件，到时磁盘会崩的</span></span><br><span class="line">    excelReader.finish();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日期、数字或者自定义格式转换"><a href="#日期、数字或者自定义格式转换" class="headerlink" title="日期、数字或者自定义格式转换"></a><span id="converterRead">日期、数字或者自定义格式转换</span></h2><h3 id="excel示例-3"><a href="#excel示例-3" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-3"><a href="#对象-3" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConverterData</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 我自定义 转换器，不管数据库传过来什么 。我给他加上“自定义：”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(converter = CustomStringStringConverter.class)</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这里用string 去接日期才能格式化。我想接收年月日格式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DateTimeFormat</span>(<span class="string">"yyyy年MM月dd日HH时mm分ss秒"</span>)</span><br><span class="line">    <span class="keyword">private</span> String date;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 我想接收百分比的数字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@NumberFormat</span>(<span class="string">"#.##%"</span>)</span><br><span class="line">    <span class="keyword">private</span> String doubleData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="监听器-3"><a href="#监听器-3" class="headerlink" title="监听器"></a>监听器</h3><p>参照：<a href="#simpleReadListener">监听器</a> 只是泛型变了</p>
<h3 id="自定义转换器"><a href="#自定义转换器" class="headerlink" title="自定义转换器"></a>自定义转换器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomStringStringConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class <span class="title">supportJavaTypeKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> String.class;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CellDataTypeEnum <span class="title">supportExcelTypeKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> CellDataTypeEnum.STRING;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这里读的时候会调用</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cellData</span></span><br><span class="line"><span class="comment">     *            NotNull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> contentProperty</span></span><br><span class="line"><span class="comment">     *            Nullable</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> globalConfiguration</span></span><br><span class="line"><span class="comment">     *            NotNull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convertToJavaData</span><span class="params">(CellData cellData, ExcelContentProperty contentProperty,</span></span></span><br><span class="line"><span class="function"><span class="params">        GlobalConfiguration globalConfiguration)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"自定义："</span> + cellData.getStringValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这里是写的时候会调用 不用管</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     *            NotNull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> contentProperty</span></span><br><span class="line"><span class="comment">     *            Nullable</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> globalConfiguration</span></span><br><span class="line"><span class="comment">     *            NotNull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CellData <span class="title">convertToExcelData</span><span class="params">(String value, ExcelContentProperty contentProperty,</span></span></span><br><span class="line"><span class="function"><span class="params">        GlobalConfiguration globalConfiguration)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CellData(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 日期、数字或者自定义格式转换</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 默认读的转换器&#123;<span class="doctag">@link</span> DefaultConverterLoader#loadDefaultReadConverter()&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> ConverterData&#125;.里面可以使用注解&#123;<span class="doctag">@link</span> DateTimeFormat&#125;、&#123;<span class="doctag">@link</span> NumberFormat&#125;或者自定义注解</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> ConverterDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">converterRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet </span></span><br><span class="line">    EasyExcel.read(fileName, ConverterData.class, <span class="keyword">new</span> ConverterDataListener())</span><br><span class="line">        <span class="comment">// 这里注意 我们也可以registerConverter来指定自定义转换器， 但是这个转换变成全局了， 所有java为string,excel为string的都会用这个转换器。</span></span><br><span class="line">        <span class="comment">// 如果就想单个字段使用请使用@ExcelProperty 指定converter</span></span><br><span class="line">        <span class="comment">// .registerConverter(new CustomStringStringConverter())</span></span><br><span class="line">        <span class="comment">// 读取sheet</span></span><br><span class="line">        .sheet().doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="多行头"><a href="#多行头" class="headerlink" title="多行头"></a><span id="complexHeaderRead">多行头</span></h2><h3 id="excel示例-4"><a href="#excel示例-4" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-4"><a href="#对象-4" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleReadObject">对象</a></p>
<h3 id="监听器-4"><a href="#监听器-4" class="headerlink" title="监听器"></a>监听器</h3><p>参照：<a href="#simpleReadListener">监听器</a></p>
<h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多行头</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> DemoDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 设置headRowNumber参数，然后读。 这里要注意headRowNumber如果不指定， 会根据你传入的class的&#123;<span class="doctag">@link</span> ExcelProperty#value()&#125;里面的表头的数量来决定行数，</span></span><br><span class="line"><span class="comment"> * 如果不传入class则默认为1.当然你指定了headRowNumber不管是否传入class都是以你传入的为准。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">complexHeaderRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet </span></span><br><span class="line">    EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> DemoDataListener()).sheet()</span><br><span class="line">        <span class="comment">// 这里可以设置1，因为头就是一行。如果多行头，可以设置其他值。不传入也可以，因为默认会根据DemoData 来解析，他没有指定头，也就是默认1行</span></span><br><span class="line">        .headRowNumber(<span class="number">1</span>).doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="同步的返回"><a href="#同步的返回" class="headerlink" title="同步的返回"></a><span id="synchronousRead">同步的返回</span></h2><h3 id="excel示例-5"><a href="#excel示例-5" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-5"><a href="#对象-5" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleReadObject">对象</a></p>
<h3 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 同步的返回，不推荐使用，如果数据量大会把数据放到内存里面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">synchronousRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet 同步读取会自动finish</span></span><br><span class="line">    List&lt;Object&gt; list = EasyExcel.read(fileName).head(DemoData.class).sheet().doReadSync();</span><br><span class="line">    <span class="keyword">for</span> (Object obj : list) &#123;</span><br><span class="line">        DemoData data = (DemoData)obj;</span><br><span class="line">        LOGGER.info(<span class="string">"读取到数据:&#123;&#125;"</span>, JSON.toJSONString(data));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里 也可以不指定class，返回一个list，然后读取第一个sheet 同步读取会自动finish</span></span><br><span class="line">    list = EasyExcel.read(fileName).sheet().doReadSync();</span><br><span class="line">    <span class="keyword">for</span> (Object obj : list) &#123;</span><br><span class="line">        <span class="comment">// 返回每条数据的键值对 表示所在的列 和所在列的值</span></span><br><span class="line">        Map&lt;Integer, String&gt; data = (Map&lt;Integer, String&gt;)obj;</span><br><span class="line">        LOGGER.info(<span class="string">"读取到数据:&#123;&#125;"</span>, JSON.toJSONString(data));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="读取表头数据"><a href="#读取表头数据" class="headerlink" title="读取表头数据"></a><span id="headerRead">读取表头数据</span></h2><h3 id="excel示例-6"><a href="#excel示例-6" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-6"><a href="#对象-6" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleReadObject">对象</a></p>
<h3 id="监听器-5"><a href="#监听器-5" class="headerlink" title="监听器"></a>监听器</h3><p>参照：<a href="#simpleReadListener">监听器</a><br>里面多了一个方法,只要重写invokeHeadMap方法即可<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 这里会一行行的返回头</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headMap</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invokeHeadMap</span><span class="params">(Map&lt;Integer, String&gt; headMap, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">    LOGGER.info(<span class="string">"解析到一条头数据:&#123;&#125;"</span>, JSON.toJSONString(headMap));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 读取表头数据</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> DemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> DemoHeadDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">headerRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet</span></span><br><span class="line">    EasyExcel.read(fileName, DemoData.class, <span class="keyword">new</span> DemoHeadDataListener()).sheet().doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数据转换等异常处理"><a href="#数据转换等异常处理" class="headerlink" title="数据转换等异常处理"></a><span id="exceptionRead">数据转换等异常处理</span></h2><h3 id="excel示例-7"><a href="#excel示例-7" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-7"><a href="#对象-7" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionDemoData</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用日期去接字符串 肯定报错</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="监听器-6"><a href="#监听器-6" class="headerlink" title="监听器"></a>监听器</h3><p>参照：<a href="#simpleReadListener">监听器</a><br>里面多了一个方法,只要重写onException方法即可<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在转换异常 获取其他异常下会调用本接口。抛出异常则停止读取。如果这里不抛出异常则 继续读取下一行。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> exception</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onException</span><span class="params">(Exception exception, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">    LOGGER.error(<span class="string">"解析失败，但是继续解析下一行:&#123;&#125;"</span>, exception.getMessage());</span><br><span class="line">    <span class="comment">// 如果是某一个单元格的转换异常 能获取到具体行号</span></span><br><span class="line">    <span class="comment">// 如果要获取头的信息 配合invokeHeadMap使用</span></span><br><span class="line">    <span class="keyword">if</span> (exception <span class="keyword">instanceof</span> ExcelDataConvertException) &#123;</span><br><span class="line">        ExcelDataConvertException excelDataConvertException = (ExcelDataConvertException)exception;</span><br><span class="line">        LOGGER.error(<span class="string">"第&#123;&#125;行，第&#123;&#125;列解析异常"</span>, excelDataConvertException.getRowIndex(),</span><br><span class="line">            excelDataConvertException.getColumnIndex());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据转换等异常处理</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> ExceptionDemoData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> DemoExceptionListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exceptionRead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = TestFileUtil.getPath() + <span class="string">"demo"</span> + File.separator + <span class="string">"demo.xlsx"</span>;</span><br><span class="line">    <span class="comment">// 这里 需要指定读用哪个class去读，然后读取第一个sheet</span></span><br><span class="line">    EasyExcel.read(fileName, ExceptionDemoData.class, <span class="keyword">new</span> DemoExceptionListener()).sheet().doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="web中的读"><a href="#web中的读" class="headerlink" title="web中的读"></a><span id="webRead">web中的读</span></h2><h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><p>DEMO代码地址：<a href="/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java">https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java</a></p>
<h3 id="excel示例-8"><a href="#excel示例-8" class="headerlink" title="excel示例"></a>excel示例</h3><p>参照：<a href="#simpleReadExcel">excel示例</a></p>
<h3 id="对象-8"><a href="#对象-8" class="headerlink" title="对象"></a>对象</h3><p>参照：<a href="#simpleReadObject">对象</a> 只是名字变了</p>
<h3 id="监听器-7"><a href="#监听器-7" class="headerlink" title="监听器"></a>监听器</h3><p>参照：<a href="#simpleReadListener">监听器</a> 只是泛型变了</p>
<h3 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文件上传</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="doctag">@link</span> UploadData&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;2. 由于默认异步读取excel，所以需要创建excel一行一行的回调监听器，参照&#123;<span class="doctag">@link</span> UploadDataListener&#125;</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;3. 直接读即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"upload"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    EasyExcel.read(file.getInputStream(), UploadData.class, <span class="keyword">new</span> UploadDataListener()).sheet().doRead();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        <div id="react-support-footer-root"></div>
      </div>
    </div>
  </div>
</div>

    


    

    <!-- js vendors -->
    <script src="//code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.0/lunr.min.js"></script>

    <!-- js source  -->
    <script src="/script/doc.js"></script>

    

  </body>
</html>
